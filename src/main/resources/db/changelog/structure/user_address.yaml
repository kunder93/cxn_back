databaseChangeLog:
- changeSet:
    id: user_address
    author: Santiago
    changes:
    - createTable:
        tableName: address
        columns:
        - column:
            name: postal_code
            type: varchar(15)
            constraints:
              nullable: false
        - column:
            name: apartment_number
            type: varchar(15)
            constraints:
              nullable: false
        - column:
            name: street
            type: varchar(50)
            constraints:
              nullable: false
        - column:
            name: city
            type: varchar(50)
            constraints:
              nullable: false
        - column:
            name: user_dni
            type: varchar(9)
            constraints:
              nullable: false
              unique: true
        - column:
            name: country_numeric_code
            type: bigint
            constraints:
              nullable: false            
        - column:
            name: country_subdivision_id
            type: bigint
            constraints:
              nullable: false
                           
    - createTable:
        tableName: country
        columns:
        - column:
            name: numeric_code
            type: bigint
            constraints:
              primaryKey: true
              nullable: false
        - column:
            name: short_name
            type: varchar(50)
            constraints:
              nullable: false
              unique: true
        - column:
            name: full_name
            type: varchar(200)
            constraints:
              nullable: false
              unique: true
        - column:
            name: alpha_2_code
            type: varchar(2)
            constraints:
              nullable: false
              unique: true
        - column:
            name: alpha_3_code
            type: varchar(3)
            constraints:
              nullable: false
              unique: true              
    - createTable:
        tableName: country_subdivision
        columns:
        - column:
            name: id
            type: bigint
            constraints:
              primaryKey: true
              nullable: false
        - column:
            name: name
            type: varchar(150)
            constraints:
              nullable: false
        - column:
            name: kind_subdivision_name
            type: varchar(50)
            constraints:
              nullable: false
        - column:
            name: country_numeric_code
            type: bigint
            constraints:
              nullable: false
                        
- changeSet:
    id: FK_country_address_subdivisions
    author: Santiago
    changes:
    - addForeignKeyConstraint:
        baseColumnNames: user_dni
        baseTableName: address
        constraintName: fk_users_has_address
        referencedColumnNames: dni
        referencedTableName: users
    - addForeignKeyConstraint:
        baseColumnNames: country_numeric_code
        baseTableName: address
        constraintName: fk_address_country
        referencedColumnNames: numeric_code
        referencedTableName: country     
    - addForeignKeyConstraint:
        baseColumnNames: country_numeric_code
        baseTableName: country_subdivision
        constraintName: fk_address_country
        referencedColumnNames: numeric_code
        referencedTableName: country        
    - addForeignKeyConstraint:
        baseColumnNames: country_subdivision_id
        baseTableName: address
        constraintName: fk_address_country_subdivision
        referencedColumnNames: id
        referencedTableName: country_subdivision             

- changeSet:
    id: PK_address_table
    author: Santiago
    changes:
        - addPrimaryKey:
            columnNames: user_dni
            constraintName: pk_address
            tableName: address
